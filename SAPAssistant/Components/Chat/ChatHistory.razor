@using SAPAssistant.Models
@using SAPAssistant.ViewModels
@inject ChatHistoryViewModel VM

<div class="sidebar">
    <button class="btn btn-primary w-100 mb-3" @onclick="VM.StartNewChat">+ Nuevo Chat</button>

    @if (VM.IsLoading)
    {
        <p>Cargando historial...</p>
    }
    else if (!VM.Sessions.Any())
    {
        <p>No hay chats guardados.</p>
    }
    else
    {
        @foreach (var chat in VM.Sessions.OrderByDescending(c => c.Fecha))
        {
            <ChatHistoryItem Chat="chat"
                             OnOpenChat="VM.OpenChat"
                             OnDeleteChat="VM.DeleteChat" />
        }
    }
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        await VM.LoadHistoryAsync();
    }
}
