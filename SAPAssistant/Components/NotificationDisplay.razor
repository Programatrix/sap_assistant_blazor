@using SAPAssistant.Service
@using SAPAssistant.Exceptions
@implements IDisposable

<AlertMessageError Result="@_message" OnClear="@ClearMessage" />

@code {
    [Inject] private NotificationService NotificationService { get; set; } = default!;

    private ResultMessage? _message;

    protected override void OnInitialized()
    {
        NotificationService.OnNotify += HandleNotification;
    }

    private void HandleNotification(ResultMessage message)
    {
        _message = message;
        InvokeAsync(StateHasChanged);
    }

    private void ClearMessage()
    {
        _message = null;
        StateHasChanged();
    }

    public void Dispose()
    {
        NotificationService.OnNotify -= HandleNotification;
    }
}
