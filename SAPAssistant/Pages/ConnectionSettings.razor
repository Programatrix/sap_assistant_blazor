@page "/connection/edit"
@layout PublicLayout
@attribute [Authorize]
@using SAPAssistant.ViewModels
@inject ConnectionSettingsViewModel VM

<div class="connection-form-wrapper">
    <h2>@(VM.IsEditMode ? "Editar Conexi칩n" : "Nueva Conexi칩n")</h2>

    <EditForm Model="@VM.ConnectionData" OnValidSubmit="VM.HandleSave">
        <div class="form-grid">
            <div class="form-group">
                <label>ID de la conexi칩n</label>
                <InputText class="form-input" @bind-Value="VM.ConnectionData.ConnectionId" disabled="@VM.IsEditMode" />
            </div>

            <div class="form-group">
                <label>Usuario</label>
                <InputText class="form-input" @bind-Value="VM.ConnectionData.User" />
            </div>

            <div class="form-group">
                <label>Host</label>
                <InputText class="form-input" @bind-Value="VM.ConnectionData.Host" />
            </div>

            <div class="form-group">
                <label>Contrase침a</label>
                <InputText type="password" class="form-input" @bind-Value="VM.ConnectionData.Password" />
            </div>

            <div class="form-group">
                <label>Puerto</label>
                <InputNumber class="form-input" @bind-Value="VM.ConnectionData.Port" />
            </div>

            <div class="form-group">
                <label>Esquema (Schema)</label>
                <InputText class="form-input" @bind-Value="VM.ConnectionData.Schema" />
            </div>

            <div class="form-group">
                <label>Base de Datos</label>
                <InputText class="form-input" @bind-Value="VM.ConnectionData.Database" />
            </div>

            <div class="form-group">
                <label>Tipo de Base de Datos</label>
                <InputSelect class="form-input" @bind-Value="VM.ConnectionData.db_type">
                    <option value="">-- Selecciona --</option>
                    <option value="SQL">SQL</option>
                    <option value="HANA">HANA</option>
                </InputSelect>
            </div>

            <div class="form-group">
                <label>IP Remota del Servidor</label>
                <InputText class="form-input" @bind-Value="VM.ConnectionData.remote_ip" />
            </div>
        </div>

        <div class="form-actions">
            <button class="save-button" type="submit">Guardar Cambios</button>
        </div>
    </EditForm>
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        await VM.InitializeAsync();
    }
}
